services:
  freebox-dashboard:
    build: .
    container_name: freebox-dashboard
    restart: unless-stopped
    ports:
      - "${DASHBOARD_PORT:-7505}:3001"
    environment:
      - SERVER_PORT=3001
      - FREEBOX_URL=${FREEBOX_URL:-https://mafreebox.freebox.fr}
      - FREEBOX_LOCAL_IP=${FREEBOX_LOCAL_IP:-192.168.1.254}
      - FREEBOX_APP_ID=${FREEBOX_APP_ID:-fr.freeboxos.dashboard}
      - FREEBOX_APP_NAME=${FREEBOX_APP_NAME:-Freebox Dashboard}
      - FREEBOX_APP_VERSION=${FREEBOX_APP_VERSION:-1.0.0}
      - FREEBOX_DEVICE_NAME=${FREEBOX_DEVICE_NAME:-Dashboard Docker}
      - FREEBOX_TOKEN_FILE=/app/data/.freebox_token
    volumes:
      - freebox_data:/app/data
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:3001/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

volumes:
  freebox_data:
